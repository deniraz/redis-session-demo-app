<!doctype html>
<html>
<head>
  <meta charset="UTF-8"/>
  <title>Redis Session Demo</title>

  <!-- 
    Basic inline styling for the UI.
    This page is intentionally simple to clearly display Redis session data,
    EC2 instance hostname, and session metadata for the demo.
  -->
  <style>
    body { 
      font-family: Arial; 
      text-align: center; 
      margin-top: 40px; 
    }
    code { 
      background: #f7f7f7; 
      padding: 6px 12px; 
      border-radius: 6px; 
      font-size: 16px;
      display: inline-block;
    }
    .box {
      width: 550px;
      margin: 25px auto;
      padding: 20px;
      border: 2px solid #ddd;
      border-radius: 12px;
      text-align: left;
      background: #fafafa;
    }
    .highlight {
      background: #d1ffd1;
      padding: 5px;
      border-radius: 4px;
      font-size: 18px;
    }
  </style>
</head>

<body>

<h2>Redis Session Sharing Demo</h2>

<div class="box">

  <!-- 
    Displays the HTTP session ID.
    Because Spring Session stores session in Redis, this ID remains the same
    across multiple EC2 instances behind an ALB.
  -->
  <p><strong>Session ID:</strong></p>
  <code th:text="${sessionId}"></code>

  <!-- Shows which EC2 instance handled this request.
       Helps demonstrate load balancing while session remains shared. -->
  <p><strong>Served From Instance:</strong></p>
  <code th:text="${host}"></code>

  <!-- Shows the exact Redis key used by Spring Session for this user session. -->
  <p><strong>Redis Key:</strong></p>
  <code th:text="${redisKey}"></code>

  <!-- TTL (Time To Live) shows how many seconds remain before the session expires. -->
  <p><strong>TTL (seconds):</strong></p>
  <code th:text="${ttl}"></code>

  <!-- Human-readable formatted timestamps for the session creation time. -->
  <p><strong>Session Creation Time:</strong></p>
  <code th:text="${#dates.format(creationTime, 'yyyy-MM-dd HH:mm:ss')}"></code>

  <!-- Last time the session was accessed, updated automatically by Spring Session. -->
  <p><strong>Last Accessed Time:</strong></p>
  <code th:text="${#dates.format(lastAccessedTime, 'yyyy-MM-dd HH:mm:ss')}"></code>

</div>

<!-- 
    - refreshing may hit different instances
    - session stays the same
    - TTL remains consistent because Redis is the backend session store
-->

<p><a href="/logout">Logout</a></p>

</body>
</html>
